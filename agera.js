"use strict";(()=>{function M(u){u.classList.contains("cloak")&&u.classList.remove("cloak")}function F(){{let u=`.cloak { 
			opacity: 0;
			height: 0px;
      overflow: hidden;
			margin: auto;
		}`,t=document.createElement("style");t.textContent=u,document.head.appendChild(t)}}var b={apiUrl:"https://utils-api.vercel.app/api/",counterPath:"counter/"};function N(u){var s,l,h,d;let t={thisUrl:new URL(window.location.href),wfSiteId:(l=(s=document.querySelector("html"))==null?void 0:s.dataset.wfSite)!=null?l:"0000",wfUrl:new URL((d=(h=document.querySelector("html"))==null?void 0:h.dataset.wfSite)!=null?d:"0000","https://webflow.com/api/v1/form/"),niceUtms:Array.from(new URLSearchParams(window.location.search),([e,r])=>`${e}: ${r}`).join(", "),redirect:u.getAttribute("redirect")||null,endpoint:u.getAttribute("action")||null,addUtm:!!u.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:u.querySelector('input[type="submit"]'),submitText:""};t.submitText=t.submitButton&&t.submitButton.value||"";function E(e,r){let f=new FormData;for(let[p,g]of new FormData(e))r.hasOwnProperty(p)?f.append(r[p],g):f.append(p,g);return f}let y={url:t.endpoint||"",method:"POST",headers:{"Content-Type":"application/json"},critical:!0},L={webFlow(e){var p;let r=new FormData(e);r.append("UTM",t.niceUtms);let f=new URLSearchParams({name:(p=e==null?void 0:e.getAttribute("name"))!=null?p:"form",source:window.location.href});for(let g of r.entries()){let T=`fields[${g[0]}]`;f.append(T,g[1])}return{...y,url:t.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:f.toString()}},mailChimp(e){var g;let f=E(e,{given_name:"FNAME",family_name:"LNAME",email:"EMAIL",tel:"PHONE",street_adress:"ADDRESS",postal_code:"POSTALCODE",adress_level2:"REGION",country:"COUNTRY"}),p=new URLSearchParams(f);return p.append("UTM",t.niceUtms),{...y,url:((g=t.endpoint)==null?void 0:g.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:p.toString()}},zapier(e){return{...y,body:JSON.stringify({[e.getAttribute("name")||"form"]:Object.fromEntries(new FormData(e)),source:t.thisUrl.hostname+t.thisUrl.pathname,time:new Date().toISOString(),UTM:t.niceUtms})}},amnesty(e){return{...y,url:new URL("amnesty",b.apiUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(e)),action_id:e.dataset.actionId||"9999",sign_method:e.dataset.signMethod||"agera-default"},UTM:t.niceUtms,site_id:t.wfSiteId})}},actionNetwork(e){let r=new FormData(e);return{...y,body:JSON.stringify({person:{given_name:r.get("given-name"),family_name:r.get("family-name"),email_addresses:[{address:r.get("email")}],phone_numbers:[{number:r.get("tel")||""}],postal_addresses:[{postal_code:r.get("postal-code")||"",address_lines:r.get("street-address")||"",region:r.get("adress-level2")||"",country:r.get("country")||""}]},add_tags:[r.getAll("tags")||""],"action_network:referrer_data":{source:t.utmSource?t.utmSource.toString():"",website:t.thisUrl.hostname+t.thisUrl.pathname}})}}};function c(e,r){let f=new FormData(r);return{...y,critical:!1,url:new URL(b.counterPath+e,b.apiUrl).toString(),body:JSON.stringify({form:"default",site_id:t.wfSiteId,last_person:f.get("given-name")||"",source:t.thisUrl})}}function w(e,r,f){let p=e.parentNode,g=p==null?void 0:p.querySelector(".w-form-done"),T=p==null?void 0:p.querySelector(".w-form-fail");r?(g&&(g.style.display="block"),T&&(T.style.display="none"),f&&o()):(g&&(g.style.display="none"),T&&(T.style.display="block"),t.submitButton&&(t.submitButton.value=t.submitText))}function o(){if(t.redirect)if(t.addUtm&&t.redirect){let e=new URL(t.redirect,t.thisUrl),r=new URLSearchParams(window.location.search);e.searchParams.forEach((p,g)=>{r.has(g)||r.set(g,p)});let f=e.origin+e.pathname+(r.toString()?"?"+r.toString():"");window.location.href=f}else window.location.href=t.redirect;else console.warn("No redirect defined")}async function i(e){return await $.ajax({url:e.url,type:e.method,data:e.body,dataType:e.dataType})}async function n(e){let r;if(e.dataType==="jsonp"?r=await i(e):r=await fetch(e.url,{method:e.method,headers:e.headers,body:e.body}),!r.ok)throw new Error(`Error fetching ${e.url}: ${r.statusText}`);return r.json()}async function a(e,r){try{let f=await Promise.allSettled(e.map(g=>n(g))),p=!1;f.forEach((g,T)=>{g.status==="rejected"&&e[T].critical&&(p=!0)}),p?w(r,!1,!1):w(r,!0,!0)}catch(f){console.error("Error in Promise.allSettled:",f),w(r,!1,!1)}}async function m(e){e.addEventListener("submit",async function(r){var v;r.preventDefault(),r.stopPropagation(),t.submitButton&&(t.submitButton.value=t.submitButton.dataset.wait||"Wait...");let f=[],p={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty"},g=((v=e.dataset.crm)==null?void 0:v.toLowerCase())||"webflow",T=e.dataset.counterUpdate;if(g&&p.hasOwnProperty(g)){let D=p[g];f.push(L[D](e))}T&&T!=="default"&&f.push(c(T,e)),f.length>0&&await a(f,e)})}return{handleForm:m}}function H(){let u=document.querySelectorAll("[data-crm]");for(let t of u)N(t).handleForm(t)}var x=class{constructor(){this.counters=new Map}async getCounter(t){if(this.counters.has(t))return this.counters.get(t);let E=new URL(b.counterPath+t,b.apiUrl),y=(async()=>{try{let c=await fetch(E);return c.ok?await c.json():void 0}catch{return}})();this.counters.set(t,y);let L=await y;return this.counters.delete(t),L}},S=new x;function R(){function u(o,i){return o>=i?100:Math.round(o/i*100)}function t(o){let i={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},n=25e4,m=Object.keys(i).map(Number).find(l=>l>=o),s=m?i[m]:n;return Math.ceil(o*1.05/s)*s}function E(o,i){return o*1.05<i.target||!i.autoTarget?i.target:t(o)}function y(o,i,n){o.style.width=u(i,n)+"%"}function L(o,i,n){try{let a=new Intl.NumberFormat(n.locale,n.notation).format(i);o.textContent=a}catch{n.notation.useGrouping=!1,n.notation.notation="standard";let a=new Intl.NumberFormat(void 0,n.notation).format(i);o.textContent=a}}function c(o,i,n){i>=n.hideBelow&&(o.style.opacity="1")}async function w(o){var h;let i=o.dataset.counterName||"default",n={target:parseInt(o.dataset.counterTarget||"0",10),hideBelow:parseInt(o.dataset.counterHideBelow||"0"),autoTarget:!!o.dataset.counterAutoTarget||!0,locale:o.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((h=o.dataset.counterNotation)==null?void 0:h.toLowerCase())||"standard",useGrouping:!0}},a;if(i.toLowerCase()==="default")a=125;else{let d=await S.getCounter(i);d?a=d.count:a=0}if(o.classList.contains("counter-current-value"))L(o,a,n),c(o,a,n);else{let d=o.querySelectorAll(".counter-current-value");for(let e of d)L(e,a,n),c(e,a,n)}let m=E(a,n),s=o.querySelectorAll(".counter-target-value");for(let d of s)L(d,m,n),c(d,a,n);let l=o.querySelectorAll(".counterbar-limiter");for(let d of l)y(d,a,m);c(o,a,n)}return{processCounterElement:w}}function A(){let u=`
      .counter-target-value,
      .counter-current-value,
      .counter_container {
          opacity: 0;
          transition: opacity 0.7s;
      }
  `,t=document.createElement("style");t.textContent=u,document.head.appendChild(t)}function U(){let u=document.querySelectorAll("[data-counter-name]"),t=R();for(let E of u)t.processCounterElement(E)}var C=(u,t=!0)=>u.cloneNode(t);function _(){var o,i;let u=document.querySelectorAll("[data-counter-name]"),E=(i=(o=Array.from(u).find(n=>n.dataset.counterLocale))==null?void 0:o.dataset.counterLocale)!=null?i:document.documentElement.lang||"en";function y(n,a){let m=C(a),s=m.querySelector('[data-template="last-person-name"]'),l=m.querySelector('[data-template="last-person-time"]');return s&&l&&(s.innerText=n.name,l.innerText=L(n.date,E)),m}function L(n,a){let m=new Date,s=new Date(n),l=new Date(s.getTime()-s.getTimezoneOffset()*6e4),h=Math.floor((m.getTime()-l.getTime())/1e3),d=new Intl.RelativeTimeFormat(a,{numeric:"auto"});if(h<60)return d.format(-h,"second");let e=Math.floor(h/60);if(e<60)return d.format(-e,"minute");let r=Math.floor(h/3600);if(r<12)return d.format(-r,"hour");let f=Math.floor(h/86400);return d.format(-f,"day")}function c(n){let a=n.last_person.names;return a.reverse(),a.filter((s,l,h)=>h.findIndex(d=>d.name===s.name)===l)}async function w(n,a){let m=a.querySelector('[data-template="last-person"]');if(!m)return;let s=m.parentElement;m.remove();let l=await S.getCounter(n);if(!l||!l.last_person||!l.last_person.names||l.last_person.names.length<2){s==null||s.remove();return}let d=c(l).map(e=>y(e,m));d.length>0&&s&&(M(s),s.append(...d)),d.forEach(e=>{setTimeout(function(){M(e)},100)})}u.forEach(n=>{let a=n.dataset.counterName||"default";w(a,n)})}function P(){function u(c,w){let o=new URLSearchParams(window.location.search).toString();c.querySelectorAll("input[data-redirect]").forEach(s=>{let l=s.getAttribute("data-redirect"),h=l+(l!=null&&l.includes("?")?"&":"?")+o.toString();s.setAttribute("data-redirect",h)});let n="",a=["first_name","given_name","fname","first","f-name","first-name","given","given-name","firstname","givenname"];w.forEach(([s,l])=>{let h=document.createTextNode(l).textContent,d=`<input type="hidden" id="${s}" name="${s}" value="${h}">`;c.insertAdjacentHTML("afterbegin",d),a.includes(s.toLowerCase())&&(n=l)});let m=document.querySelectorAll("[data-insert-name]");m.length>0&&n!==""&&E(m,n)}function t(c){let w=new URLSearchParams(window.location.search),o=Array.from(w,([m,s])=>`${m}: ${s}`);localStorage.removeItem("multistepforward");let i=c.getAttribute("redirect"),n=i+(i!=null&&i.includes("?")?"&":"?")+w.toString();c.setAttribute("redirect",n),c.setAttribute("data-redirect",n),c.addEventListener("change",()=>{a(c)}),c.addEventListener("input",()=>{a(c)});function a(m){let s=new FormData(m),l=o.join(", ");s.set("utm",l),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(s)))}}function E(c,w){let o={"no-space":w,"leading-space":"&nbsp;"+w,"trailing-space":w+"&nbsp;","double-space":"&nbsp;"+w+"&nbsp;"};c.forEach(i=>{let n=i.getAttribute("data-insert-name")||"leading-space";o.hasOwnProperty(n)&&(i.innerHTML=o[n])})}let y=document.querySelectorAll("[data-crm]"),L=document.querySelectorAll('[data-load-petition="true"]');y.length>0&&y.forEach(function(c){t(c)}),L.length>0&&localStorage!==null&&L.forEach(function(c){if(localStorage.hasOwnProperty("forwardedform")){let w=JSON.parse(localStorage.getItem("forwardedform")||"{}");u(c,Object.entries(w)),localStorage.removeItem("forwardedform")}})}function O(){F(),A(),document.addEventListener("DOMContentLoaded",()=>{P(),U(),H(),_()})}window.agera||(window.agera=!0,O());})();
