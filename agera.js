"use strict";(()=>{function x(t){t&&t.classList.contains("cloak")&&t.classList.remove("cloak")}function C(){{let t=`.cloak { 
			opacity: 0;
			height: 0px;
      overflow: hidden;
			margin: 0;
      padding-top: 0;
      padding-bottom: 0;
		}`,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}}var L={apiUrl:"https://utils-api.vercel.app/api/",counterPath:"counter/",jsDelivrUrl:"https://data.jsdelivr.com/v1/packages/gh/ageraplattformen/agera.js/resolved?specifier=latest"};var _=class{constructor(){this.counters=new Map}async getCounter(e){if(this.counters.has(e))return this.counters.get(e);let u=new URL(L.counterPath+e,L.apiUrl),r=(async()=>{try{let c=await fetch(u);return c.ok?await c.json():void 0}catch{return}})();this.counters.set(e,r);let m=await r;return this.counters.delete(e),m}},T=new _;async function R(){try{let t=await fetch(L.jsDelivrUrl);return t.ok?`v${(await t.json()).version}`:"latest"}catch{return"latest"}}async function A(){let t=document.querySelectorAll("[data-js-version]");if(t.length<1)return;let e=document.querySelector('script[src$="agera.js"]'),u="";if(e){let{src:r}=e,m=r.match(/@([^/]+)/);if(m){let[,c]=m;u=c,u.toLowerCase().includes("latest")&&(u=await R())}}u!==""&&t.forEach(r=>{r.innerText=u})}function P(){let t=new URLSearchParams(window.location.search);document.querySelectorAll("[data-redirect]").forEach(u=>{let r=u.getAttribute("data-redirect");try{if(r){let m=new URL(r,document.baseURI),c=new URL(m.toString()),f=c.searchParams;t.forEach((s,i)=>{f.has(i)||f.set(i,s)}),u.setAttribute("data-redirect",c.toString())}}catch(m){console.error("An error occurred:",m)}})}var H,D,N,I,S={thisUrl:new URL(window.location.href),wfSiteId:(D=(H=document.querySelector("html"))==null?void 0:H.dataset.wfSite)!=null?D:"0000",wfUrl:new URL((I=(N=document.querySelector("html"))==null?void 0:N.dataset.wfSite)!=null?I:"0000","https://webflow.com/api/v1/form/"),niceUtms:Array.from(new URLSearchParams(window.location.search),([t,e])=>`${t}: ${e}`).join(", "),utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source")||""};function F(t,e){let u=new FormData;for(let[r,m]of new FormData(t))e.hasOwnProperty(r)?u.append(e[r],m):u.append(r,m);return u}var b={method:"POST",headers:{"Content-Type":"application/json"},critical:!0},v={webFlow(t){var r;let e=new FormData(t);e.append("UTM",S.niceUtms);let u=new URLSearchParams({name:(r=t==null?void 0:t.getAttribute("name"))!=null?r:"form",source:window.location.href});for(let m of e.entries()){let c=`fields[${m[0]}]`;u.append(c,m[1])}return{...b,url:S.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u.toString()}},mailChimp(t){var m;let u=F(t,{"given-name":"FNAME","family-name":"LNAME",email:"EMAIL",tel:"PHONE","street-adress":"ADDRESS","postal-code":"POSTALCODE","adress-level2":"REGION",country:"COUNTRY"}),r=new URLSearchParams;for(let[c,f]of u.entries())(typeof f=="string"||typeof f=="number")&&r.append(c,f.toString());return r.append("UTM",S.niceUtms),{...b,url:((m=t.getAttribute("action"))==null?void 0:m.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:r.toString()}},zapier(t){return{...b,url:t.getAttribute("action")||"",body:JSON.stringify({[t.getAttribute("name")||"form"]:Object.fromEntries(new FormData(t)),source:S.thisUrl.hostname+S.thisUrl.pathname,time:new Date().toISOString(),UTM:S.niceUtms})}},amnesty(t){return{...b,url:new URL("amnesty",L.apiUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(t)),action_id:t.dataset.actionId||"9999",sign_method:t.dataset.signMethod||"agera-default"},UTM:S.niceUtms,site_id:S.wfSiteId})}},actionNetwork(t){let e=new FormData(t);return{...b,url:t.getAttribute("action")||"",body:JSON.stringify({person:{given_name:e.get("given-name"),family_name:e.get("family-name"),email_addresses:[{address:e.get("email")}],phone_numbers:[{number:e.get("tel")||""}],postal_addresses:[{postal_code:e.get("postal-code")||"",address_lines:e.get("street-address")||"",region:e.get("adress-level2")||"",country:e.get("country")||""}]},add_tags:[e.getAll("tags")||""],"action_network:referrer_data":{source:S.utmSource?S.utmSource.toString():"",website:S.thisUrl.hostname+S.thisUrl.pathname}})}},profundo(t,e){let r=t?F(t,{"given-name":"firstname","family-name":"lastname",email:"email",tel:"mobile","street-adress":"address","postal-code":"zip",country:"country_id"}):void 0,m=e==null?void 0:e.name.name_id;r||(r=new FormData);let c=(e==null?void 0:e.activity.shorttext)||(t==null?void 0:t.dataset.profundoText),f=(t==null?void 0:t.dataset.registerId)||(e==null?void 0:e.register_id),s=(t==null?void 0:t.dataset.campaignId)||(e==null?void 0:e.campaign_id),i=(t==null?void 0:t.dataset.classificationId)||(e==null?void 0:e.activity.classification_id)||"SI",o=r&&{...Object.fromEntries(r)};return m&&(o.name_id=Number(m)),{...b,critical:!m,url:new URL("profundo",L.apiUrl).toString(),body:JSON.stringify({client:(t==null?void 0:t.dataset.client)||(e==null?void 0:e.client)||"not_provided",client_url:(t==null?void 0:t.getAttribute("action"))||(e==null?void 0:e.client_url)||"",name:o,...f?{register_id:f}:{},...s?{campaign_id:s}:{},...m?{}:{text1:"utm: "+S.niceUtms},...c?{shorttext:c}:{},activity:{activitytype_id:(t==null?void 0:t.dataset.activitytypeId)||(e==null?void 0:e.activity.activitytype_id)||"UN",...i?{classification_id:i}:{}}})}}};function k(t){document.querySelectorAll("[data-profundo-client]").forEach(r=>{r.addEventListener("click",async()=>{let m=v.profundo(void 0,{client:r.dataset.profundoClient||"not_provided",client_url:r.dataset.profundoUrl||"not_provided",name:{name_id:Number(t)},register_id:r.dataset.registerId||"",campaign_id:Number(r.dataset.campaignId)||void 0,activity:{activitytype_id:r.dataset.activitytypeId||"UN",classification_id:r.dataset.classificationId||"UN",shorttext:r.dataset.profundoText||""}});await u(m)})});async function u(r){try{let m=await fetch(r.url,{method:r.method,headers:r.headers,body:r.body});return m.ok?await m.json():void 0}catch{return}}}function O(t,e){t.data&&e.push(t.data)}function G(t){var l,g,d,h;let e={thisUrl:new URL(window.location.href),wfSiteId:(g=(l=document.querySelector("html"))==null?void 0:l.dataset.wfSite)!=null?g:"0000",wfUrl:new URL((h=(d=document.querySelector("html"))==null?void 0:d.dataset.wfSite)!=null?h:"0000","https://webflow.com/api/v1/form/"),redirect:t.getAttribute("redirect")||null,addUtm:!!t.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:t.querySelector('input[type="submit"]'),submitText:"",niceUtms:Array.from(new URLSearchParams(window.location.search),([a,n])=>`${a}: ${n}`).join(", ")};e.submitText=e.submitButton&&e.submitButton.value||"";function u(a,n){let p=new FormData(n);return{method:"POST",headers:{"Content-Type":"application/json"},critical:!1,url:new URL(L.counterPath+a,L.apiUrl).toString(),body:JSON.stringify({form:"default",site_id:e.wfSiteId,last_person:p.get("given-name")||"",form_url:e.thisUrl})}}function r(a,n,p){let w=a.parentNode,y=w==null?void 0:w.querySelector(".w-form-done"),E=w==null?void 0:w.querySelector(".w-form-fail");n?(y&&(y.style.display="block"),E&&(E.style.display="none"),p&&m()):(y&&(y.style.display="none"),E&&(E.style.display="block"),e.submitButton&&(e.submitButton.value=e.submitText))}function m(){if(e.redirect)if(e.addUtm&&e.redirect){let a=new URL(e.redirect,e.thisUrl),n=new URLSearchParams(window.location.search);a.searchParams.forEach((w,y)=>{n.has(y)||n.set(y,w)});let p=a.origin+a.pathname+(n.toString()?"?"+n.toString():"");window.location.href=p}else window.location.href=e.redirect;else console.warn("No redirect defined")}async function c(a){return new Promise((n,p)=>{$.ajax({url:a.url,type:a.method,data:a.body,dataType:"jsonp",success:w=>{n(w)},error:(w,y,E)=>{p(E)}})})}async function f(a){if(a.dataType==="jsonp")return c(a);try{let n=await fetch(a.url,{method:a.method,headers:a.headers,body:a.body});if(!n.ok)throw new Error(`Error fetching ${a.url}: ${n.statusText}`);return n.json()}catch(n){throw console.error("An error occurred:",n),n}}function s(a){let n=[];a.forEach(w=>{if(w.status==="fulfilled"&&w.value){let y=w.value;O(y,n)}});let p=n.reduce((w,y)=>({...w,...y}),{});localStorage.setItem("crm_data",JSON.stringify(p))}async function i(a,n){try{let p=await Promise.allSettled(a.map(y=>f(y))),w=!1;p.forEach((y,E)=>{y.status==="rejected"&&a[E].critical&&(w=!0)}),w?r(n,!1,!1):(s(p),r(n,!0,!0))}catch(p){console.error("Error in Promise.allSettled:",p),r(n,!1,!1)}}async function o(a){a.addEventListener("submit",async function(n){var M;n.preventDefault(),n.stopPropagation(),e.submitButton&&(e.submitButton.value=e.submitButton.dataset.wait||e.submitButton.value);let p=[],w={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty",profundo:"profundo"},y=((M=a.dataset.crm)==null?void 0:M.toLowerCase())||"webflow",E=a.dataset.counterUpdate;if(y&&w.hasOwnProperty(y)){let z=w[y];p.push(v[z](a))}E&&E!=="default"&&p.push(u(E,a)),p.length>0&&await i(p,a)})}return{handleForm:o}}function j(){let t=document.querySelectorAll("[data-crm]");for(let e of t)G(e).handleForm(e)}function K(){function t(s,i){return s>=i?100:Math.round(s/i*100)}function e(s){let i={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},o=25e4,g=Object.keys(i).map(Number).find(h=>h>=s),d=g?i[g]:o;return Math.ceil(s*1.05/d)*d}function u(s,i){return s*1.05<i.target||!i.autoTarget?i.target:e(s)}function r(s,i,o){s.style.width=t(i,o)+"%"}function m(s,i,o){try{let l=new Intl.NumberFormat(o.locale,o.notation).format(i);s.textContent=l}catch{o.notation.useGrouping=!1,o.notation.notation="standard";let l=new Intl.NumberFormat(void 0,o.notation).format(i);s.textContent=l}}function c(s,i,o){i>=o.hideBelow&&(s.style.opacity="1")}async function f(s){var a;let i=s.dataset.counterName||"default",o={target:parseInt(s.dataset.counterTarget||"0",10),hideBelow:parseInt(s.dataset.counterHideBelow||"0"),autoTarget:!!s.dataset.counterAutoTarget||!0,locale:s.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((a=s.dataset.counterNotation)==null?void 0:a.toLowerCase())||"standard",useGrouping:!0}},l;if(i.toLowerCase()==="default")l=125;else{let n=await T.getCounter(i);n?l=n.count:l=0}if(s.classList.contains("counter-current-value"))m(s,l,o),c(s,l,o);else{let n=s.querySelectorAll(".counter-current-value");for(let p of n)m(p,l,o),c(p,l,o)}let g=u(l,o),d=s.querySelectorAll(".counter-target-value");for(let n of d)m(n,g,o),c(n,l,o);let h=s.querySelectorAll(".counterbar-limiter");for(let n of h)r(n,l,g);c(s,l,o)}return{processCounterElement:f}}function q(){let t=`
      .counter-target-value,
      .counter-current-value,
      .counter_container {
          opacity: 0;
          transition: opacity 0.7s;
      }
  `,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}function B(){let t=document.querySelectorAll("[data-counter-name]"),e=K();for(let u of t)e.processCounterElement(u)}var U=(t,e=!0)=>t.cloneNode(e);function V(){var s,i;let t=document.querySelectorAll("[data-counter-name]"),u=(i=(s=Array.from(t).find(o=>o.dataset.counterLocale))==null?void 0:s.dataset.counterLocale)!=null?i:document.documentElement.lang||"en";u.toLowerCase()==="none"&&(u=document.documentElement.lang||"en");function r(o,l){let g=U(l),d=g.querySelector('[data-template="last-person-name"]'),h=g.querySelector('[data-template="last-person-time"]');return d&&h&&(d.innerText=o.name,h.innerText=m(o.date,u)),g}function m(o,l){let g=new Date,d=new Date(o),h=new Date(d.getTime()-d.getTimezoneOffset()*6e4),a=Math.floor((g.getTime()-h.getTime())/1e3),n=new Intl.RelativeTimeFormat(l,{numeric:"auto"});if(a<60)return n.format(-a,"second");let p=Math.floor(a/60);if(p<60)return n.format(-p,"minute");let w=Math.floor(a/3600);if(w<12)return n.format(-w,"hour");let y=Math.floor(a/86400);return n.format(-y,"day")}function c(o){let l=o.last_person.names;return l.reverse(),l.filter((d,h,a)=>a.findIndex(n=>n.name===d.name)===h)}async function f(o,l){let g=l.querySelector('[data-template="last-person"]');if(!g)return;let d=g.parentElement;g.remove();let h=await T.getCounter(o);if(!h||!h.last_person||!h.last_person.names||h.last_person.names.length<2){d==null||d.remove();return}let n=c(h).map(p=>r(p,g));n.length>0&&d&&(x(d),d.append(...n)),n.forEach(p=>{setTimeout(function(){x(p)},100)})}t.forEach(o=>{let l=o.dataset.counterName||"default";f(l,o)})}function J(){function t(c,f){function s(){let d=localStorage.getItem("crm_data");if(!d)return localStorage.removeItem("crm_data"),null;let h=JSON.parse(d);return localStorage.removeItem("crm_data"),h}let i=s();i&&i.name_id&&(k(i.name_id),f.push(["name_id",i.name_id.toString()]));let o="",l=["first_name","first-name","firstname","first","fname","f-name","given_name","given-name","givenname","given"];f.forEach(([d,h])=>{let a=document.createTextNode(h).textContent,n=`<input type="hidden" id="${d}" name="${d}" value="${a}">`;c.insertAdjacentHTML("afterbegin",n),l.includes(d.toLowerCase())&&(o=h)});let g=document.querySelectorAll("[data-insert-name]");g.length>0&&o!==""&&u(g,o)}function e(c){let f=new URLSearchParams(window.location.search),s=Array.from(f,([g,d])=>`${g}: ${d}`),i=c.getAttribute("redirect"),o=i+(i!=null&&i.includes("?")?"&":"?")+f.toString();c.setAttribute("redirect",o),c.setAttribute("data-redirect",o),c.addEventListener("change",()=>{l(c)}),c.addEventListener("input",()=>{l(c)});function l(g){let d=new FormData(g),h=s.join(", ");d.set("utm",h),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(d)))}}function u(c,f){let s={"no-space":f,"leading-space":"&nbsp;"+f,"trailing-space":f+"&nbsp;","double-space":"&nbsp;"+f+"&nbsp;"};c.forEach(i=>{let o=i.getAttribute("data-insert-name")||"leading-space";s.hasOwnProperty(o)&&(i.innerHTML=s[o])})}let r=document.querySelectorAll("[data-crm]"),m=document.querySelectorAll('[data-load-petition="true"]');r.length>0&&r.forEach(function(c){e(c)}),m.length>0&&localStorage!==null&&m.forEach(function(c){if(localStorage.hasOwnProperty("forwardedform")){let f=JSON.parse(localStorage.getItem("forwardedform")||"{}");t(c,Object.entries(f)),localStorage.removeItem("forwardedform")}})}function W(){C(),q(),document.addEventListener("DOMContentLoaded",()=>{P(),J(),B(),j(),V(),A()})}window.agera||(window.agera=!0,W());})();
