"use strict";(()=>{var S={apiUrl:"https://utils-api.vercel.app/api/",counterPath:"counter/",jsDelivrUrl:"https://data.jsdelivr.com/v1/packages/gh/ageraplattformen/agera.js/resolved?specifier=latest"},R={method:"POST",headers:{"Content-Type":"application/json"},critical:!0};function D(t){document.querySelectorAll("[data-profundo-client]").forEach(n=>{n.addEventListener("click",async()=>{let a=n.dataset.activitytypeId||"",m=n.dataset.classificationId||"",p=n.dataset.profundoText||"",i=M(void 0,{client:n.dataset.profundoClient||"not_provided",client_url:n.dataset.profundoUrl||"not_provided",country_code:n.dataset.countryCode||"",name:{name_id:Number(t)},register_id:n.dataset.registerId||"",campaign_id:Number(n.dataset.campaignId)||void 0,activity:{...a?{activitytype_id:a}:{activitytype_id:""},...m?{classification_id:m}:{},...p?{shortText:p}:{},shorttext:n.dataset.profundoText||""}});await c(i)})});async function c(n){try{let a=await fetch(n.url,{method:n.method,headers:n.headers,body:n.body});return a.ok?await a.json():void 0}catch(a){console.log("P error: ",a);return}}}function H(t,e){t.data&&e.push(t.data)}function M(t,e){let n=t?b(t,{"given-name":"firstname","family-name":"lastname",email:"email",tel:"mobile","street-adress":"address","postal-code":"zip",country:"country_id"}):void 0,a=e==null?void 0:e.name.name_id;n||(n=new FormData);let m=(e==null?void 0:e.activity.shorttext)||(t==null?void 0:t.dataset.profundoText),p=(t==null?void 0:t.dataset.registerId)||(e==null?void 0:e.register_id),i=(t==null?void 0:t.dataset.campaignId)||(e==null?void 0:e.campaign_id),u=(t==null?void 0:t.dataset.classificationId)||(e==null?void 0:e.activity.classification_id)||"SI",s=n&&{...Object.fromEntries(n)},l=(t==null?void 0:t.getAttribute("data-country-code"))||(e==null?void 0:e.country_code)||"";a&&(s.name_id=Number(a));let g={...E.campaign?{text1:E.campaign}:"",...E.source?{text2:E.source}:"",...E.medium?{text3:E.medium}:"",...E.content?{text4:E.content}:""};return{...R,critical:!a,url:new URL("profundo/",S.apiUrl).toString(),body:JSON.stringify({client:(t==null?void 0:t.dataset.client)||(e==null?void 0:e.client)||"not_provided",client_url:(t==null?void 0:t.getAttribute("action"))||(e==null?void 0:e.client_url)||"",...l?{country_code:l}:{},referrer:window.location.href,body:{name:s,...p?{register_id:p}:{},...i?{campaign_id:i}:{},activity:{...a?{}:{...g},...m?{shorttext:m}:{},activitytype_id:(t==null?void 0:t.dataset.activitytypeId)||(e==null?void 0:e.activity.activitytype_id)||"UN",...u?{classification_id:u}:{}}}})}}function b(t,e){let c=new FormData;for(let[n,a]of new FormData(t))e.hasOwnProperty(n)?c.append(e[n],a):c.append(n,a);return c}var _=new URLSearchParams(window.location.search);function Z(){function t(c){let n=[..._.keys()].find(a=>a.toLowerCase().includes(c));return n&&_.get(n)||""}return{source:t("source").toLowerCase(),campaign:t("campaign").toLowerCase(),medium:t("medium").toLowerCase(),content:t("content").toLowerCase()}}var E=Z(),x=Array.from(_,([t,e])=>`${t.toLowerCase()}: ${e.toLowerCase()}`).join(", ");var k,N,I,O,T={thisUrl:new URL(window.location.href),wfSiteId:(N=(k=document.querySelector("html"))==null?void 0:k.dataset.wfSite)!=null?N:"0000",wfUrl:new URL((O=(I=document.querySelector("html"))==null?void 0:I.dataset.wfSite)!=null?O:"0000","https://webflow.com/api/v1/form/")},v={method:"POST",headers:{"Content-Type":"application/json"},critical:!0},j={webFlow(t){var n;let e=new FormData(t);e.append("UTM",x);let c=new URLSearchParams({name:(n=t==null?void 0:t.getAttribute("name"))!=null?n:"form",source:window.location.href});for(let a of e.entries()){let m=`fields[${a[0]}]`;c.append(m,a[1])}return{...v,url:T.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c.toString()}},mailChimp(t){var a;let c=b(t,{"given-name":"FNAME","family-name":"LNAME",email:"EMAIL",tel:"PHONE","street-adress":"ADDRESS","postal-code":"POSTALCODE","adress-level2":"REGION",country:"COUNTRY"}),n=new URLSearchParams;for(let[m,p]of c.entries())(typeof p=="string"||typeof p=="number")&&n.append(m,p.toString());return n.append("UTM",x),{...v,url:((a=t.getAttribute("action"))==null?void 0:a.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:n.toString()}},zapier(t){return{...v,url:t.getAttribute("action")||"",body:JSON.stringify({[t.getAttribute("name")||"form"]:Object.fromEntries(new FormData(t)),source:T.thisUrl.hostname+T.thisUrl.pathname,time:new Date().toISOString(),UTM:x})}},amnesty(t){let e=(t==null?void 0:t.getAttribute("data-country-code"))||"";return{...v,url:new URL("amnesty",S.apiUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(t)),action_id:t.dataset.actionId||"9999",sign_method:t.dataset.signMethod||"agera-default"},UTM:x,site_id:T.wfSiteId,...e?{country_code:e}:{}})}},actionNetwork(t){let e=new FormData(t);return{...v,url:t.getAttribute("action")||"",body:JSON.stringify({person:{given_name:e.get("given-name"),family_name:e.get("family-name"),email_addresses:[{address:e.get("email")}],phone_numbers:[{number:e.get("tel")||""}],postal_addresses:[{postal_code:e.get("postal-code")||"",address_lines:e.get("street-address")||"",region:e.get("adress-level2")||"",country:e.get("country")||""}]},add_tags:[e.getAll("tags")||""],"action_network:referrer_data":{source:E.source?E.source.toString():"",website:T.thisUrl.hostname+T.thisUrl.pathname}})}},profundo:M};function ee(t){var l,g,h,y;let e={thisUrl:new URL(window.location.href),wfSiteId:(g=(l=document.querySelector("html"))==null?void 0:l.dataset.wfSite)!=null?g:"0000",wfUrl:new URL((y=(h=document.querySelector("html"))==null?void 0:h.dataset.wfSite)!=null?y:"0000","https://webflow.com/api/v1/form/"),redirect:t.getAttribute("redirect")||null,addUtm:!!t.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:t.querySelector('input[type="submit"]'),submitText:"",niceUtms:Array.from(new URLSearchParams(window.location.search),([o,r])=>`${o}: ${r}`).join(", ")};e.submitText=e.submitButton&&e.submitButton.value||"";function c(o,r){let d=new FormData(r);return{method:"POST",headers:{"Content-Type":"application/json"},critical:!1,url:new URL(S.counterPath+o,S.apiUrl).toString(),body:JSON.stringify({form:"default",site_id:e.wfSiteId,last_person:d.get("given-name")||"",form_url:e.thisUrl})}}function n(o,r,d){let f=o.parentNode,w=f==null?void 0:f.querySelector(".w-form-done"),L=f==null?void 0:f.querySelector(".w-form-fail");r?(w&&(w.style.display="block"),L&&(L.style.display="none"),d&&a()):(w&&(w.style.display="none"),L&&(L.style.display="block"),e.submitButton&&(e.submitButton.value=e.submitText))}function a(){if(e.redirect)if(e.addUtm&&e.redirect){let o=new URL(e.redirect,e.thisUrl),r=new URLSearchParams(window.location.search);o.searchParams.forEach((f,w)=>{r.has(w)||r.set(w,f)});let d=o.origin+o.pathname+(r.toString()?"?"+r.toString():"");window.location.href=d}else window.location.href=e.redirect;else console.warn("No redirect defined")}async function m(o){return new Promise((r,d)=>{$.ajax({url:o.url,type:o.method,data:o.body,dataType:"jsonp",success:f=>{r(f)},error:(f,w,L)=>{d(L)}})})}async function p(o){if(o.dataType==="jsonp")return m(o);try{let r=await fetch(o.url,{method:o.method,headers:o.headers,body:o.body});if(!r.ok)throw new Error(`Error fetching ${o.url}: ${r.statusText}`);return r.json()}catch(r){throw console.error("An error occurred:",r),r}}function i(o){let r=[];o.forEach(f=>{if(f.status==="fulfilled"&&f.value){let w=f.value;H(w,r)}});let d=r.reduce((f,w)=>({...f,...w}),{});localStorage.setItem("crm_data",JSON.stringify(d))}async function u(o,r){try{let d=await Promise.allSettled(o.map(w=>p(w))),f=!1;d.forEach((w,L)=>{w.status==="rejected"&&o[L].critical&&(f=!0)}),f?n(r,!1,!1):(i(d),n(r,!0,!0))}catch(d){console.error("Error in Promise.allSettled:",d),n(r,!1,!1)}}async function s(o){o.addEventListener("submit",async function(r){var F;r.preventDefault(),r.stopPropagation(),e.submitButton&&(e.submitButton.value=e.submitButton.dataset.wait||e.submitButton.value);let d=[],f={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty",profundo:"profundo"},w=((F=o.dataset.crm)==null?void 0:F.toLowerCase())||"webflow",L=o.dataset.counterUpdate;if(w&&f.hasOwnProperty(w)){let Q=f[w];d.push(j[Q](o))}L&&L!=="default"&&d.push(c(L,o)),d.length>0&&await u(d,o)})}return{handleForm:s}}function q(){let t=document.querySelectorAll("[data-crm]");for(let e of t)ee(e).handleForm(e)}var U=class{constructor(){this.counters=new Map}async getCounter(e){if(this.counters.has(e))return this.counters.get(e);let c=new URL(S.counterPath+e,S.apiUrl),n=(async()=>{try{let m=await fetch(c);return m.ok?await m.json():void 0}catch{return}})();this.counters.set(e,n);let a=await n;return this.counters.delete(e),a}},C=new U;async function V(){try{let t=await fetch(S.jsDelivrUrl);return t.ok?`v${(await t.json()).version}`:"latest"}catch{return"latest"}}function te(){function t(i,u){return i>=u?100:Math.round(i/u*100)}function e(i){let u={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},s=25e4,g=Object.keys(u).map(Number).find(y=>y>=i),h=g?u[g]:s;return Math.ceil(i*1.05/h)*h}function c(i,u){return i*1.05<u.target||!u.autoTarget?u.target:e(i)}function n(i,u,s){i.style.width=t(u,s)+"%"}function a(i,u,s){try{let l=new Intl.NumberFormat(s.locale,s.notation).format(u);i.textContent=l}catch{s.notation.useGrouping=!1,s.notation.notation="standard";let l=new Intl.NumberFormat(void 0,s.notation).format(u);i.textContent=l}}function m(i,u,s){u>=s.hideBelow&&(i.style.opacity="1")}async function p(i){var o;let u=i.dataset.counterName||"default",s={target:parseInt(i.dataset.counterTarget||"0",10),hideBelow:parseInt(i.dataset.counterHideBelow||"0"),autoTarget:!!i.dataset.counterAutoTarget||!0,locale:i.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((o=i.dataset.counterNotation)==null?void 0:o.toLowerCase())||"standard",useGrouping:!0}},l;if(u.toLowerCase()==="default")l=125;else{let r=await C.getCounter(u);r?l=r.count:l=0}if(i.classList.contains("counter-current-value"))a(i,l,s),m(i,l,s);else{let r=i.querySelectorAll(".counter-current-value");for(let d of r)a(d,l,s),m(d,l,s)}let g=c(l,s),h=i.querySelectorAll(".counter-target-value");for(let r of h)a(r,g,s),m(r,l,s);let y=i.querySelectorAll(".counterbar-limiter");for(let r of y)n(r,l,g);m(i,l,s)}return{processCounterElement:p}}function B(){let t=`
      .counter-target-value,
      .counter-current-value,
      .counter_container {
          opacity: 0;
          transition: opacity 0.7s;
      }
  `,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}function J(){let t=document.querySelectorAll("[data-counter-name]"),e=te();for(let c of t)e.processCounterElement(c)}var P=(t,e=!0)=>t.cloneNode(e);function A(t){t&&t.classList.contains("cloak")&&t.classList.remove("cloak")}function z(){{let t=`.cloak { 
			opacity: 0;
			height: 0px;
      overflow: hidden;
			margin: 0;
      padding-top: 0;
      padding-bottom: 0;
		}`,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}}function G(){var i,u;let t=document.querySelectorAll("[data-counter-name]"),c=(u=(i=Array.from(t).find(s=>s.dataset.counterLocale))==null?void 0:i.dataset.counterLocale)!=null?u:document.documentElement.lang||"en";c.toLowerCase()==="none"&&(c=document.documentElement.lang||"en");function n(s,l){let g=P(l),h=g.querySelector('[data-template="last-person-name"]'),y=g.querySelector('[data-template="last-person-time"]');return h&&y&&(h.innerText=s.name,y.innerText=a(s.date,c)),g}function a(s,l){let g=new Date,h=new Date(s),y=new Date(h.getTime()-h.getTimezoneOffset()*6e4),o=Math.floor((g.getTime()-y.getTime())/1e3),r=new Intl.RelativeTimeFormat(l,{numeric:"auto"});if(o<60)return r.format(-o,"second");let d=Math.floor(o/60);if(d<60)return r.format(-d,"minute");let f=Math.floor(o/3600);if(f<12)return r.format(-f,"hour");let w=Math.floor(o/86400);return r.format(-w,"day")}function m(s){let l=s.last_person.names;return l.reverse(),l.filter((h,y,o)=>o.findIndex(r=>r.name===h.name)===y)}async function p(s,l){let g=l.querySelector('[data-template="last-person"]');if(!g)return;let h=g.parentElement;g.remove();let y=await C.getCounter(s);if(!y||!y.last_person||!y.last_person.names||y.last_person.names.length<2){h==null||h.remove();return}let r=m(y).map(d=>n(d,g));r.length>0&&h&&(A(h),h.append(...r)),r.forEach(d=>{setTimeout(function(){A(d)},100)})}t.forEach(s=>{let l=s.dataset.counterName||"default";p(l,s)})}function K(){function t(m){function p(){let o=JSON.parse(localStorage.getItem("forwardedform")||"{}");return localStorage.removeItem("forwardedform"),Object.entries(o)}let i=p();function u(){let o=localStorage.getItem("crm_data");return o?(localStorage.removeItem("crm_data"),JSON.parse(o)):(localStorage.removeItem("crm_data"),null)}let s=u();s&&s.name_id&&(D(s.name_id),i.push(["name_id",s.name_id.toString()]));function l(o){let r=Array.from(new URLSearchParams(window.location.search),([d,f])=>`${d}: ${f}`).join(", ");return o.find(([d])=>d==="utm")||o.push(["utm",r]),o}let g=l(i);function h(o){o.forEach(([r,d])=>{let f=document.createTextNode(d).textContent,w=`<input type="hidden" id="${r}" name="${r}" value="${f}">`;m.insertAdjacentHTML("afterbegin",w)})}h(g);function y(o){let r="",d=["first_name","first-name","firstname","first","fname","f-name","given_name","given-name","givenname","given"];o.forEach(([w,L])=>{d.includes(w.toLowerCase())&&(r=L)});let f=document.querySelectorAll("[data-insert-name]");f.length>0&&r!==""&&c(f,r)}y(g)}function e(m){let p=new URLSearchParams(window.location.search),i=Array.from(p,([g,h])=>`${g}: ${h}`),u=m.getAttribute("redirect"),s=u+(u!=null&&u.includes("?")?"&":"?")+p.toString();m.setAttribute("redirect",s),m.setAttribute("data-redirect",s),m.addEventListener("change",()=>{l(m)}),m.addEventListener("input",()=>{l(m)});function l(g){let h=new FormData(g),y=i.join(", ");h.set("utm",y),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(h)))}}function c(m,p){let i={"no-space":p,"leading-space":"&nbsp;"+p,"trailing-space":p+"&nbsp;","double-space":"&nbsp;"+p+"&nbsp;"};m.forEach(u=>{let s=u.getAttribute("data-insert-name")||"leading-space";i.hasOwnProperty(s)&&(u.innerHTML=i[s])})}let n=document.querySelectorAll("[data-crm]");n.length>0&&n.forEach(function(m){e(m)});let a=document.querySelectorAll('[data-load-petition="true"]');a.length>0&&a.forEach(function(m){t(m)})}async function Y(){let t=document.querySelectorAll("[data-js-version]");if(t.length<1)return;let e=document.querySelector('script[src$="agera.js"]'),c="";if(e){let{src:n}=e,a=n.match(/@([^/]+)/);if(a){let[,m]=a;c=m,c.toLowerCase().includes("latest")&&(c=await V())}}c!==""&&t.forEach(n=>{n.innerText=c})}function W(){let t=new URLSearchParams(window.location.search);document.querySelectorAll("[data-redirect]").forEach(c=>{let n=c.getAttribute("data-redirect");try{if(n){let a=new URL(n,document.baseURI),m=new URL(a.toString()),p=m.searchParams;t.forEach((i,u)=>{p.has(u)||p.set(u,i)}),c.setAttribute("data-redirect",m.toString())}}catch(a){console.error("An error occurred:",a)}})}function X(){let t=[document.documentElement.lang||"en","en"];document.querySelectorAll("[data-insert-time]").forEach(n=>{n.innerText=ne(n,t)}),document.querySelectorAll("[data-remaining-days-to]").forEach(n=>{n.innerText=re(n,t)})}function ne(t,e){let c=new Date,n=t.getAttribute("data-insert-time"),a="";if((n==null?void 0:n.toLowerCase())==="year")a=c.getFullYear().toString();else if((n==null?void 0:n.toLowerCase())==="month")a=(c.getMonth()+1).toString();else if((n==null?void 0:n.toLowerCase())==="day")a=c.getDate().toString();else if((n==null?void 0:n.toLowerCase())==="date")a=c.toLocaleDateString(e);else if((n==null?void 0:n.toLowerCase())==="datetime")a=c.toLocaleString(e);else if((n==null?void 0:n.toLowerCase())==="time")a=c.toLocaleTimeString(e);else return"";return a}function re(t,e){let c=new Date,n=t.getAttribute("data-remaining-days-to");try{if(n){let a=new Date(n),m=Math.round((a.getTime()-c.getTime())/(1e3*60*60*24));return new Intl.RelativeTimeFormat(e,{numeric:"auto"}).format(m,"day")}}catch(a){console.error("remainingDays error:",a)}return""}function ae(){B(),z(),document.addEventListener("DOMContentLoaded",()=>{K(),J(),q(),G(),X(),W(),Y()})}window.agera||(window.agera=!0,ae());})();
