"use strict";(()=>{function F(f){var l,h,y,E;let e={thisUrl:new URL(window.location.href),wfSiteId:(h=(l=document.querySelector("html"))==null?void 0:l.dataset.wfSite)!=null?h:"0000",wfUrl:new URL((E=(y=document.querySelector("html"))==null?void 0:y.dataset.wfSite)!=null?E:"0000","https://webflow.com/api/v1/form/"),backendUrl:"https://utils-api.vercel.app",niceUtms:Array.from(new URLSearchParams(window.location.search),([r,t])=>`${r}: ${t}`).join(", "),redirect:f.getAttribute("redirect")||null,endpoint:f.getAttribute("action")||null,addUtm:!!f.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:f.querySelector('input[type="submit"]'),submitText:""};e.submitText=e.submitButton&&e.submitButton.value||"";function s(r,t){let i=new FormData;for(let[c,d]of new FormData(r))t.hasOwnProperty(c)?i.append(t[c],d):i.append(c,d);return i}let p={url:e.endpoint||"",method:"POST",headers:{"Content-Type":"application/json"}},g={webFlow(r){var c;let t=new FormData(r);t.append("UTM",e.niceUtms);let i=new URLSearchParams({name:(c=r==null?void 0:r.getAttribute("name"))!=null?c:"form",source:window.location.href});for(let d of t.entries()){let L=`fields[${d[0]}]`;i.append(L,d[1])}return{...p,url:e.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.toString()}},mailChimp(r){var d;let i=s(r,{given_name:"FNAME",family_name:"LNAME",email:"EMAIL",tel:"PHONE",street_adress:"ADDRESS",postal_code:"POSTALCODE",adress_level2:"REGION",country:"COUNTRY"}),c=new URLSearchParams(i);return c.append("UTM",e.niceUtms),{...p,url:((d=e.endpoint)==null?void 0:d.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:c.toString()}},zapier(r){return{...p,body:JSON.stringify({[r.getAttribute("name")||"form"]:Object.fromEntries(new FormData(r)),source:e.thisUrl.hostname+e.thisUrl.pathname,time:new Date().toISOString(),UTM:e.niceUtms})}},amnesty(r){return{...p,url:new URL("/api/amnesty",e.backendUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(r)),action_id:r.dataset.actionId||"9999",sign_method:r.dataset.signMethod||"agera-default"},UTM:e.niceUtms,site_id:e.wfSiteId})}},actionNetwork(r){let t=new FormData(r);return{...p,body:JSON.stringify({person:{given_name:t.get("given-name"),family_name:t.get("family-name"),email_addresses:[{address:t.get("email")}],phone_numbers:[{number:t.get("tel")||""}],postal_addresses:[{postal_code:t.get("postal-code")||"",address_lines:t.get("street-address")||"",region:t.get("adress-level2")||"",country:t.get("country")||""}]},add_tags:[t.getAll("tags")||""],"action_network:referrer_data":{source:e.utmSource?e.utmSource.toString():"",website:e.thisUrl.hostname+e.thisUrl.pathname}})}}};function u(r){return{...p,url:new URL("api/counter/"+r,e.backendUrl).toString(),body:JSON.stringify({form:"default",site_id:e.wfSiteId})}}function m(r,t){let i=r.parentNode,c=i==null?void 0:i.querySelector(".w-form-done"),d=i==null?void 0:i.querySelector(".w-form-fail");t?(c&&(c.style.display="block"),d&&(d.style.display="none")):(c&&(c.style.display="none"),d&&(d.style.display="block"),e.submitButton&&(e.submitButton.value=e.submitText))}function w(){if(e.redirect)if(console.log("Redirecting..."),e.addUtm&&e.redirect){let r=new URL(e.redirect,e.thisUrl),t=new URLSearchParams(window.location.search);r.searchParams.forEach((c,d)=>{t.has(d)||t.set(d,c)});let i=r.origin+r.pathname+(t.toString()?"?"+t.toString():"");window.location.href=i}else window.location.href=e.redirect;else console.log("No redirect defined")}async function n(r){try{return await $.ajax({url:r.url,type:r.method,data:r.body,dataType:r.dataType})}catch(t){throw console.error(t),new Error(String(t))}}async function o(r,t){try{let i=r.map(async c=>{if(!c.dataType){let d=await fetch(c.url,{method:c.method,headers:c.headers,body:c.body});if(!d.ok)throw m(t,!1),new Error("Response error");return d.json()}if(c.dataType==="jsonp")return await n(c)});await Promise.all(i),m(t,!0),w()}catch(i){m(t,!1),console.error("An error occurred:",i)}}async function a(r){r.addEventListener("submit",async function(t){var M;t.preventDefault(),t.stopPropagation(),e.submitButton&&(e.submitButton.value=e.submitButton.dataset.wait||"Wait...");let i=[],c={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty"},d=((M=r.dataset.crm)==null?void 0:M.toLowerCase())||"webflow",L=r.dataset.counterUpdate;if(d&&c.hasOwnProperty(d)){let v=c[d];i.push(g[v](r))}L&&L!=="default"&&i.push(u(L)),i.length>0&&await o(i,r)})}return{handleForm:a}}document.addEventListener("DOMContentLoaded",function(){let f=document.querySelectorAll("[data-crm]");for(let e of f)F(e).handleForm(e)});var U="https://utils-api.vercel.app/api/counter/";async function T(f){let e=new URL(f,U);try{let s=await fetch(e);return s.ok?await s.json():void 0}catch{return}}function H(){let f="https://utils-api.vercel.app/api/counter/";function e(n,o){return n>=o?100:Math.round(n/o*100)}function s(n){let o={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},a=25e4,h=Object.keys(o).map(Number).find(E=>E>=n),y=h?o[h]:a;return Math.ceil(n*1.05/y)*y}function p(n,o){return n*1.05<o.target||!o.autoTarget?o.target:s(n)}function g(n,o,a){n.style.width=e(o,a)+"%"}function u(n,o,a){try{let l=new Intl.NumberFormat(a.locale,a.notation).format(o);n.textContent=l}catch{a.notation.useGrouping=!1,a.notation.notation="standard";let l=new Intl.NumberFormat(void 0,a.notation).format(o);n.textContent=l}}function m(n,o,a){o>=a.hideBelow&&(n.style.opacity="1")}async function w(n){var r;let o=n.dataset.counterName||"default",a={target:parseInt(n.dataset.counterTarget||"0",10),hideBelow:parseInt(n.dataset.counterHideBelow||"0"),autoTarget:!!n.dataset.counterAutoTarget||!0,locale:n.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((r=n.dataset.counterNotation)==null?void 0:r.toLowerCase())||"standard",useGrouping:!0}},l;if(o.toLowerCase()==="default")l=125;else{let t=await T(o);t?l=t.count:l=0}if(n.classList.contains("counter-current-value"))u(n,l,a),m(n,l,a);else{let t=n.querySelectorAll(".counter-current-value");for(let i of t)u(i,l,a),m(i,l,a)}let h=p(l,a),y=n.querySelectorAll(".counter-target-value");for(let t of y)u(t,h,a),m(t,l,a);let E=n.querySelectorAll(".counterbar-limiter");for(let t of E)g(t,l,h);m(n,l,a)}return{processCounterElement:w}}(function(){{let e=`
        .counter-target-value,
        .counter-current-value,
        .counter_container {
            opacity: 0;
            transition: opacity 0.7s;
        }
    `,s=document.createElement("style");s.textContent=e,document.head.appendChild(s)}document.addEventListener("DOMContentLoaded",function(){let e=document.querySelectorAll("[data-counter-name]"),s=H();for(let p of e)s.processCounterElement(p)})})();{let f=function(s,p){let g="",u=["first_name","given_name","fname","first","f-name","first-name","given","given-name","firstname","givenname"];p.forEach(([o,a])=>{let l=document.createTextNode(a).textContent,h=`<input type="hidden" id="${o}" name="${o}" value="${l}">`;s.insertAdjacentHTML("afterbegin",h),u.includes(o.toLowerCase())&&(g=a)});let m=new URLSearchParams(window.location.search).toString();s.querySelectorAll("input[data-redirect]").forEach(o=>{let a=o.getAttribute("data-redirect"),l=a+(a!=null&&a.includes("?")?"&":"?")+m.toString();o.setAttribute("data-redirect",l)}),document.querySelectorAll("[data-insert-name]").forEach(o=>{o.innerHTML="&nbsp;"+g})},e=function(s){let p=new URLSearchParams(window.location.search),g=[];p.forEach((n,o)=>{g.push(`${o}: ${n}`)}),localStorage.removeItem("multistepforward");let u=s.getAttribute("redirect"),m=u+(u!=null&&u.includes("?")?"&":"?")+p.toString();s.setAttribute("redirect",m),s.setAttribute("data-redirect",m),s.addEventListener("change",()=>{w(s)}),s.addEventListener("input",()=>{w(s)});function w(n){let o=new FormData(n),a=g.join(", ");o.set("utm",a),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(o)))}};N=f,O=e,document.addEventListener("DOMContentLoaded",function(){let s=document.querySelectorAll("[data-crm]"),p=document.querySelectorAll('[data-load-petition="true"]');s.length>0&&s.forEach(function(g){e(g)}),p.length>0&&localStorage!==null&&p.forEach(function(g){if(localStorage.hasOwnProperty("forwardedform")){let u=JSON.parse(localStorage.getItem("forwardedform")||"{}");f(g,Object.entries(u)),localStorage.removeItem("forwardedform")}})})}var N,O;function b(f){f.classList.contains("cloak")&&f.classList.remove("cloak")}function x(){{let f=`.cloak { 
			opacity: 0;
			height: 0px;
			overflow: hidden;
			margin: auto;
		}`,e=document.createElement("style");e.textContent=f,document.head.appendChild(e)}}var S=(f,e=!0)=>f.cloneNode(e);function C(){let e={locale:document.querySelectorAll("[data-counter-name]")[0].dataset.counterLocale||document.documentElement.lang||"en"};function s(g,u){let m=S(u),w=m.querySelector('[data-template="last-person-name"]'),n=m.querySelector('[data-template="last-person-time"]');return w&&n&&(w.innerText=g.name,n.innerText=p(g.date,e.locale)),m}function p(g,u){let m=new Date,w=new Date(g),n=new Date(w.getTime()-w.getTimezoneOffset()*6e4),o=Math.floor((m.getTime()-n.getTime())/1e3),a=new Intl.RelativeTimeFormat(u,{numeric:"auto"});if(o<60)return a.format(-o,"second");let l=Math.floor(o/60);if(l<60)return a.format(-l,"minute");let h=Math.floor(o/3600);if(h<12)return a.format(-h,"hour");let y=Math.floor(o/86400);return a.format(-y,"day")}(async function(){let u=document.querySelector('[data-template="last-person"]');if(!u)return;let m=u.parentElement;u.remove();let w=await T("test5437");if(!w){m==null||m.remove();return}w.last_person.names.reverse();let n=w.last_person.names.map(o=>s(o,u));n.length>0&&m&&(b(m),m.append(...n)),n.forEach(o=>{setTimeout(function(){b(o)},100)})})()}x();document.addEventListener("DOMContentLoaded",()=>{C()});})();
