"use strict";(()=>{function x(m){m.classList.contains("cloak")&&m.classList.remove("cloak")}function v(){{let m=`.cloak { 
			opacity: 0;
			height: 0px;
      overflow: hidden;
			margin: auto;
		}`,t=document.createElement("style");t.textContent=m,document.head.appendChild(t)}}var b={apiUrl:"https://utils-api.vercel.app/api/",counterPath:"counter/"};function P(m){var i,c,E,w;let t={thisUrl:new URL(window.location.href),wfSiteId:(c=(i=document.querySelector("html"))==null?void 0:i.dataset.wfSite)!=null?c:"0000",wfUrl:new URL((w=(E=document.querySelector("html"))==null?void 0:E.dataset.wfSite)!=null?w:"0000","https://webflow.com/api/v1/form/"),niceUtms:Array.from(new URLSearchParams(window.location.search),([e,a])=>`${e}: ${a}`).join(", "),redirect:m.getAttribute("redirect")||null,endpoint:m.getAttribute("action")||null,addUtm:!!m.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:m.querySelector('input[type="submit"]'),submitText:""};t.submitText=t.submitButton&&t.submitButton.value||"";function y(e,a){let f=new FormData;for(let[u,d]of new FormData(e))a.hasOwnProperty(u)?f.append(a[u],d):f.append(u,d);return f}let h={url:t.endpoint||"",method:"POST",headers:{"Content-Type":"application/json"},critical:!0},L={webFlow(e){var u;let a=new FormData(e);a.append("UTM",t.niceUtms);let f=new URLSearchParams({name:(u=e==null?void 0:e.getAttribute("name"))!=null?u:"form",source:window.location.href});for(let d of a.entries()){let T=`fields[${d[0]}]`;f.append(T,d[1])}return{...h,url:t.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:f.toString()}},mailChimp(e){var d;let f=y(e,{given_name:"FNAME",family_name:"LNAME",email:"EMAIL",tel:"PHONE",street_adress:"ADDRESS",postal_code:"POSTALCODE",adress_level2:"REGION",country:"COUNTRY"}),u=new URLSearchParams(f);return u.append("UTM",t.niceUtms),{...h,url:((d=t.endpoint)==null?void 0:d.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:u.toString()}},zapier(e){return{...h,body:JSON.stringify({[e.getAttribute("name")||"form"]:Object.fromEntries(new FormData(e)),source:t.thisUrl.hostname+t.thisUrl.pathname,time:new Date().toISOString(),UTM:t.niceUtms})}},amnesty(e){return{...h,url:new URL("amnesty",b.apiUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(e)),action_id:e.dataset.actionId||"9999",sign_method:e.dataset.signMethod||"agera-default"},UTM:t.niceUtms,site_id:t.wfSiteId})}},actionNetwork(e){let a=new FormData(e);return{...h,body:JSON.stringify({person:{given_name:a.get("given-name"),family_name:a.get("family-name"),email_addresses:[{address:a.get("email")}],phone_numbers:[{number:a.get("tel")||""}],postal_addresses:[{postal_code:a.get("postal-code")||"",address_lines:a.get("street-address")||"",region:a.get("adress-level2")||"",country:a.get("country")||""}]},add_tags:[a.getAll("tags")||""],"action_network:referrer_data":{source:t.utmSource?t.utmSource.toString():"",website:t.thisUrl.hostname+t.thisUrl.pathname}})}}};function l(e,a){let f=new FormData(a);return{...h,critical:!1,url:new URL(b.counterPath+e,b.apiUrl).toString(),body:JSON.stringify({form:"default",site_id:t.wfSiteId,last_person:f.get("given-name")||"",source:t.thisUrl})}}function g(e,a,f){let u=e.parentNode,d=u==null?void 0:u.querySelector(".w-form-done"),T=u==null?void 0:u.querySelector(".w-form-fail");a?(d&&(d.style.display="block"),T&&(T.style.display="none"),f&&n()):(d&&(d.style.display="none"),T&&(T.style.display="block"),t.submitButton&&(t.submitButton.value=t.submitText))}function n(){if(t.redirect)if(t.addUtm&&t.redirect){let e=new URL(t.redirect,t.thisUrl),a=new URLSearchParams(window.location.search);e.searchParams.forEach((u,d)=>{a.has(d)||a.set(d,u)});let f=e.origin+e.pathname+(a.toString()?"?"+a.toString():"");window.location.href=f}else window.location.href=t.redirect;else console.warn("No redirect defined")}async function o(e){return await $.ajax({url:e.url,type:e.method,data:e.body,dataType:e.dataType})}async function r(e){let a;if(e.dataType==="jsonp"?a=await o(e):a=await fetch(e.url,{method:e.method,headers:e.headers,body:e.body}),!a.ok)throw new Error(`Error fetching ${e.url}: ${a.statusText}`);return a.json()}async function s(e,a){try{let f=await Promise.allSettled(e.map(d=>r(d))),u=!1;f.forEach((d,T)=>{d.status==="rejected"&&e[T].critical&&(u=!0)}),u?g(a,!1,!1):g(a,!0,!0)}catch(f){console.error("Error in Promise.allSettled:",f),g(a,!1,!1)}}async function p(e){e.addEventListener("submit",async function(a){var C;a.preventDefault(),a.stopPropagation(),t.submitButton&&(t.submitButton.value=t.submitButton.dataset.wait||"Wait...");let f=[],u={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty"},d=((C=e.dataset.crm)==null?void 0:C.toLowerCase())||"webflow",T=e.dataset.counterUpdate;if(d&&u.hasOwnProperty(d)){let A=u[d];f.push(L[A](e))}T&&T!=="default"&&f.push(l(T,e)),f.length>0&&await s(f,e)})}return{handleForm:p}}function F(){let m=document.querySelectorAll("[data-crm]");for(let t of m)P(t).handleForm(t)}async function S(m){let t=new URL(b.counterPath+m,b.apiUrl);try{let y=await fetch(t);return y.ok?await y.json():void 0}catch{return}}function R(){function m(n,o){return n>=o?100:Math.round(n/o*100)}function t(n){let o={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},r=25e4,p=Object.keys(o).map(Number).find(c=>c>=n),i=p?o[p]:r;return Math.ceil(n*1.05/i)*i}function y(n,o){return n*1.05<o.target||!o.autoTarget?o.target:t(n)}function h(n,o,r){n.style.width=m(o,r)+"%"}function L(n,o,r){try{let s=new Intl.NumberFormat(r.locale,r.notation).format(o);n.textContent=s}catch{r.notation.useGrouping=!1,r.notation.notation="standard";let s=new Intl.NumberFormat(void 0,r.notation).format(o);n.textContent=s}}function l(n,o,r){o>=r.hideBelow&&(n.style.opacity="1")}async function g(n){var E;let o=n.dataset.counterName||"default",r={target:parseInt(n.dataset.counterTarget||"0",10),hideBelow:parseInt(n.dataset.counterHideBelow||"0"),autoTarget:!!n.dataset.counterAutoTarget||!0,locale:n.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((E=n.dataset.counterNotation)==null?void 0:E.toLowerCase())||"standard",useGrouping:!0}},s;if(o.toLowerCase()==="default")s=125;else{let w=await S(o);w?s=w.count:s=0}if(n.classList.contains("counter-current-value"))L(n,s,r),l(n,s,r);else{let w=n.querySelectorAll(".counter-current-value");for(let e of w)L(e,s,r),l(e,s,r)}let p=y(s,r),i=n.querySelectorAll(".counter-target-value");for(let w of i)L(w,p,r),l(w,s,r);let c=n.querySelectorAll(".counterbar-limiter");for(let w of c)h(w,s,p);l(n,s,r)}return{processCounterElement:g}}function H(){let m=`
      .counter-target-value,
      .counter-current-value,
      .counter_container {
          opacity: 0;
          transition: opacity 0.7s;
      }
  `,t=document.createElement("style");t.textContent=m,document.head.appendChild(t)}function U(){let m=document.querySelectorAll("[data-counter-name]"),t=R();for(let y of m)t.processCounterElement(y)}var M=(m,t=!0)=>m.cloneNode(t);function N(){var l,g;let m=document.querySelectorAll("[data-counter-name]"),t={locale:((l=m[0])==null?void 0:l.dataset.counterLocale)||document.documentElement.lang||"en",counterName:((g=m[0])==null?void 0:g.dataset.counterName)||"default"};function y(n,o){let r=M(o),s=r.querySelector('[data-template="last-person-name"]'),p=r.querySelector('[data-template="last-person-time"]');return s&&p&&(s.innerText=n.name,p.innerText=h(n.date,t.locale)),r}function h(n,o){let r=new Date,s=new Date(n),p=new Date(s.getTime()-s.getTimezoneOffset()*6e4),i=Math.floor((r.getTime()-p.getTime())/1e3),c=new Intl.RelativeTimeFormat(o,{numeric:"auto"});if(i<60)return c.format(-i,"second");let E=Math.floor(i/60);if(E<60)return c.format(-E,"minute");let w=Math.floor(i/3600);if(w<12)return c.format(-w,"hour");let e=Math.floor(i/86400);return c.format(-e,"day")}function L(n){let o=n.last_person.names;return o.reverse(),o.filter((s,p,i)=>i.findIndex(c=>c.name===s.name)===p)}(async function(){let o=document.querySelector('[data-template="last-person"]');if(!o)return;let r=o.parentElement;o.remove();let s=await S(t.counterName);if(!s){r==null||r.remove();return}let i=L(s).map(c=>y(c,o));i.length>0&&r&&(x(r),r.append(...i)),i.forEach(c=>{setTimeout(function(){x(c)},100)})})()}function _(){function m(l,g){let n=new URLSearchParams(window.location.search).toString();l.querySelectorAll("input[data-redirect]").forEach(i=>{let c=i.getAttribute("data-redirect"),E=c+(c!=null&&c.includes("?")?"&":"?")+n.toString();i.setAttribute("data-redirect",E)});let r="",s=["first_name","given_name","fname","first","f-name","first-name","given","given-name","firstname","givenname"];g.forEach(([i,c])=>{let E=document.createTextNode(c).textContent,w=`<input type="hidden" id="${i}" name="${i}" value="${E}">`;l.insertAdjacentHTML("afterbegin",w),s.includes(i.toLowerCase())&&(r=c)});let p=document.querySelectorAll("[data-insert-name]");p.length>0&&r!==""&&y(p,r)}function t(l){let g=new URLSearchParams(window.location.search),n=Array.from(g,([p,i])=>`${p}: ${i}`);localStorage.removeItem("multistepforward");let o=l.getAttribute("redirect"),r=o+(o!=null&&o.includes("?")?"&":"?")+g.toString();l.setAttribute("redirect",r),l.setAttribute("data-redirect",r),l.addEventListener("change",()=>{s(l)}),l.addEventListener("input",()=>{s(l)});function s(p){let i=new FormData(p),c=n.join(", ");i.set("utm",c),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(i)))}}function y(l,g){let n={"no-space":g,"leading-space":"&nbsp;"+g,"trailing-space":g+"&nbsp;","double-space":"&nbsp;"+g+"&nbsp;"};l.forEach(o=>{let r=o.getAttribute("data-insert-name")||"leading-space";n.hasOwnProperty(r)&&(o.innerHTML=n[r])})}let h=document.querySelectorAll("[data-crm]"),L=document.querySelectorAll('[data-load-petition="true"]');h.length>0&&h.forEach(function(l){t(l)}),L.length>0&&localStorage!==null&&L.forEach(function(l){if(localStorage.hasOwnProperty("forwardedform")){let g=JSON.parse(localStorage.getItem("forwardedform")||"{}");m(l,Object.entries(g)),localStorage.removeItem("forwardedform")}})}window.agera||(v(),H());document.addEventListener("DOMContentLoaded",()=>{window.agera||(window.agera=!0,_(),U(),F(),N())});})();
