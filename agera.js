"use strict";(()=>{var S={apiUrl:"https://utils-api.vercel.app/api/",counterPath:"counter/",jsDelivrUrl:"https://data.jsdelivr.com/v1/packages/gh/ageraplattformen/agera.js/resolved?specifier=latest"},b={method:"POST",headers:{"Content-Type":"application/json"},critical:!0};function it(t){document.querySelectorAll("[data-profundo-client]").forEach(n=>{n.addEventListener("click",async()=>{let o=n.dataset.activitytypeId||"",a=n.dataset.classificationId||"",f=n.dataset.profundoText||"",c=F(void 0,{client:n.dataset.profundoClient||"not_provided",client_url:n.dataset.profundoUrl||"not_provided",country_code:n.dataset.countryCode||"",name:{name_id:Number(t)},register_id:n.dataset.registerId||"",campaign_id:Number(n.dataset.campaignId)||void 0,activity:{...o?{activitytype_id:o}:{activitytype_id:""},...a?{classification_id:a}:{},...f?{shortText:f}:{},shorttext:n.dataset.profundoText||""}});await r(c)})});async function r(n){try{let o=await fetch(n.url,{method:n.method,headers:n.headers,body:n.body});return o.ok?await o.json():void 0}catch(o){console.log("P error: ",o);return}}}function N(t,e){let r=t["data.name_id"];t&&r&&(it(r.toString()),e==null||e.push(["name_id",r.toString()]))}function F(t,e){let n=t?E(t,{"given-name":"firstname","family-name":"lastname",email:"email",tel:"mobile","street-adress":"address","postal-code":"zip",country:"country_id"}):void 0,o=e==null?void 0:e.name.name_id;n||(n=new FormData);let a=[];for(let[h,i]of n.entries())if(h.startsWith("infotype")){let s=parseInt(i);isNaN(s)||a.push(s),n.delete(h)}let f=(t==null?void 0:t.getAttribute("data-country-code"))||(e==null?void 0:e.country_code)||"";!(n!=null&&n.get("country"))&&f&&n.append("country",f);let c=(e==null?void 0:e.activity.shorttext)||(t==null?void 0:t.dataset.profundoText),m=(t==null?void 0:t.dataset.registerId)||(e==null?void 0:e.register_id),u=(t==null?void 0:t.dataset.campaignId)||(e==null?void 0:e.campaign_id),l=(t==null?void 0:t.dataset.classificationId)||(e==null?void 0:e.activity.classification_id)||"SI",g=n&&{...Object.fromEntries(n)};o&&(g.name_id=Number(o));let d={...y.campaign?{text1:y.campaign}:"",...y.source?{text2:y.source}:"",...y.medium?{text3:y.medium}:"",...y.content?{text4:y.content}:""};return{...b,critical:!o,url:new URL("profundo/",S.apiUrl).toString(),body:JSON.stringify({client:(t==null?void 0:t.dataset.client)||(e==null?void 0:e.client)||"not_provided",client_url:(t==null?void 0:t.getAttribute("action"))||(e==null?void 0:e.client_url)||"",...f?{country_code:f}:{},referrer:window.location.href,body:{name:g,...m?{register_id:m}:{},...u?{campaign_id:u}:{},...a?{infotype_id:a[0]}:{},activity:{...o?{}:{...d},...c?{shorttext:c}:{},activitytype_id:(t==null?void 0:t.dataset.activitytypeId)||(e==null?void 0:e.activity.activitytype_id)||"UN",...l?{classification_id:l}:{}}}})}}function ct(t){document.querySelectorAll("[data-unhcr-se-patch]").forEach(n=>{n.addEventListener("click",async()=>{let o=ut(void 0,{body:{id:t.toString()},country_code:n.dataset.countryCode||"",campaign_id:Number(n.dataset.campaignId)||void 0});await r(o)})});async function r(n){try{let o=await fetch(n.url,{method:n.method,headers:n.headers,body:n.body});return o.ok?await o.json():void 0}catch(o){console.log("SF error: ",o);return}}}function O(t,e){let{id:r}=t;t&&r&&(ct(r.toString()),e==null||e.push(["id",r.toString()]))}function ut(t,e){let n=t?E(t,{"given-name":"FirstName","family-name":"LastName",email:"Email",tel:"Phone"}):void 0,o=(e==null?void 0:e.body.id)||"";n||(n=new FormData);let a=[];for(let[m,u]of n.entries())if(m.startsWith("infotype")){let l=parseInt(u);isNaN(l)||a.push(l),n.delete(m)}let f=(t==null?void 0:t.getAttribute("data-country-code"))||(e==null?void 0:e.country_code)||"";!(n!=null&&n.get("country"))&&f&&n.append("country",f);let c={utm:{...y.campaign?{utm_campaign:y.campaign}:"",...y.source?{utm_source:y.source}:"",...y.medium?{utm_medium:y.medium}:"",...y.content?{utm_content:y.content}:""}};return{...b,url:new URL(`/unhcr-se/${o}`,S.apiUrl).toString(),body:JSON.stringify({body:{...n,...Object.keys(c.utm).length>0?{utm:c}:{}},...f?{country_code:f}:{},campaign_id:e==null?void 0:e.campaign_id,source:window.location.href})}}var P=(t,e)=>{let r={};for(let n in t){let o=t[n],a=e?`${e}.${n}`:n;typeof o=="object"&&o!==null?Object.assign(r,P(o,a)):r[a]=o}return r};function I(t){function e(){let n=localStorage.getItem("crm_data");return n||localStorage.removeItem("crm_data"),JSON.parse(n)}let r=P(e());r&&(N(r,t),O(r,t))}function j(t){return typeof t=="object"&&t.hasOwnProperty("count")&&typeof t.count=="number"&&t.hasOwnProperty("name")&&typeof t.name=="string"}function E(t,e){let r=new FormData;for(let[n,o]of new FormData(t))e.hasOwnProperty(n)?r.append(e[n],o):r.append(n,o);return r}var R=new URLSearchParams(window.location.search);function mt(){function t(r){let n=[...R.keys()].find(o=>o.toLowerCase().includes(r));return n&&R.get(n)||""}return{source:t("source").toLowerCase(),campaign:t("campaign").toLowerCase(),medium:t("medium").toLowerCase(),content:t("content").toLowerCase()}}var y=mt(),x=Array.from(R,([t,e])=>`${t.toLowerCase()}: ${e.toLowerCase()}`).join(", ");function q(t){let e=new FormData(t),r={};t&&Array.from(t.attributes).forEach(a=>{a.name.startsWith("data-")&&(r[a.name]=a.value)});let n={utms:{...y.campaign?{utm_campaign:y.campaign}:"",...y.source?{utm_source:y.source}:"",...y.medium?{utm_medium:y.medium}:"",...y.content?{utm_content:y.content}:""}};return{...b,url:new URL("fcrm/",S.apiUrl).toString(),body:JSON.stringify({crm:(t==null?void 0:t.dataset.crm)||"",...t!=null&&t.dataset.crmClient?{client:t.dataset.crmClient}:{},...t!=null&&t.action?{endpoint:t.action}:{},body:{...Object.fromEntries(e)},...n?{...n}:{},source:window.location.href,...r?{attributes:{...r}}:{}})}}var V,B,J,z,v={thisUrl:new URL(window.location.href),wfSiteId:(B=(V=document.querySelector("html"))==null?void 0:V.dataset.wfSite)!=null?B:"0000",wfUrl:new URL((z=(J=document.querySelector("html"))==null?void 0:J.dataset.wfSite)!=null?z:"0000","https://webflow.com/api/v1/form/")},C={method:"POST",headers:{"Content-Type":"application/json"},critical:!0},U={webFlow(t){var n;let e=new FormData(t);e.append("UTM",x);let r=new URLSearchParams({name:(n=t==null?void 0:t.getAttribute("name"))!=null?n:"form",source:window.location.href});for(let o of e.entries()){let a=`fields[${o[0]}]`;r.append(a,o[1])}return{...C,url:v.wfUrl.href,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()}},mailChimp(t){var o;let r=E(t,{"given-name":"FNAME","family-name":"LNAME",email:"EMAIL",tel:"PHONE","street-adress":"ADDRESS","postal-code":"POSTALCODE","adress-level2":"REGION",country:"COUNTRY"}),n=new URLSearchParams;for(let[a,f]of r.entries())(typeof f=="string"||typeof f=="number")&&n.append(a,f.toString());return n.append("UTM",x),{...C,url:((o=t.getAttribute("action"))==null?void 0:o.replace("post?","post-json?"))+"&c=?",headers:{"Content-Type":"application/x-www-form-urlencoded"},dataType:"jsonp",body:n.toString()}},zapier(t){return{...C,url:t.getAttribute("action")||"",body:JSON.stringify({[t.getAttribute("name")||"form"]:Object.fromEntries(new FormData(t)),source:v.thisUrl.hostname+v.thisUrl.pathname,time:new Date().toISOString(),UTM:x})}},amnesty(t){let e=(t==null?void 0:t.getAttribute("data-country-code"))||"";return{...C,url:new URL("amnesty/",S.apiUrl).toString(),body:JSON.stringify({form:{...Object.fromEntries(new FormData(t)),action_id:t.dataset.actionId||"9999",sign_method:t.dataset.signMethod||"agera-default"},UTM:x,site_id:v.wfSiteId,...e?{country_code:e}:{}})}},actionNetwork(t){let e=new FormData(t),r=[];for(let[n,o]of e.entries())n.startsWith("tags")&&r.push(o);return{...C,url:t.getAttribute("action")||"",body:JSON.stringify({person:{given_name:e.get("given-name"),family_name:e.get("family-name"),email_addresses:[{address:e.get("email")}],phone_numbers:[{number:e.get("tel")||""}],postal_addresses:[{postal_code:e.get("postal-code")||"",address_lines:e.get("street-address")||"",region:e.get("adress-level2")||"",country:e.get("country")||""}]},add_tags:[...r],"action_network:referrer_data":{source:y.source?y.source.toString():"",website:v.thisUrl.hostname+v.thisUrl.pathname}})}},profundo:F,fcrm:q};function lt(t){var l,g,d,h;let e={thisUrl:new URL(window.location.href),wfSiteId:(g=(l=document.querySelector("html"))==null?void 0:l.dataset.wfSite)!=null?g:"0000",wfUrl:new URL((h=(d=document.querySelector("html"))==null?void 0:d.dataset.wfSite)!=null?h:"0000","https://webflow.com/api/v1/form/"),redirect:t.getAttribute("redirect")||null,addUtm:!!t.dataset.redirectUtm||!0,utmSource:new URLSearchParams(window.location.search).get("utm_source")||new URLSearchParams(window.location.search).get("source"),submitButton:t.querySelector('input[type="submit"]'),submitText:"",niceUtms:Array.from(new URLSearchParams(window.location.search),([i,s])=>`${i}: ${s}`).join(", ")};e.submitText=e.submitButton&&e.submitButton.value||"";function r(i,s){let p=new FormData(s);return{method:"POST",headers:{"Content-Type":"application/json"},critical:!1,url:new URL(S.counterPath+i,S.apiUrl).toString(),body:JSON.stringify({form:"default",site_id:e.wfSiteId,last_person:p.get("given-name")||"",form_url:e.thisUrl})}}function n(i,s,p){let w=i.parentNode,L=w==null?void 0:w.querySelector(".w-form-done"),T=w==null?void 0:w.querySelector(".w-form-fail");s?(L&&(L.style.display="block"),T&&(T.style.display="none"),p&&o()):(L&&(L.style.display="none"),T&&(T.style.display="block"),e.submitButton&&(e.submitButton.value=e.submitText))}function o(){if(e.redirect)if(e.addUtm&&e.redirect){let i=new URL(e.redirect,e.thisUrl),s=new URLSearchParams(window.location.search);i.searchParams.forEach((w,L)=>{s.has(L)||s.set(L,w)});let p=i.origin+i.pathname+(s.toString()?"?"+s.toString():"");window.location.href=p}else window.location.href=e.redirect;else console.warn("No redirect defined")}async function a(i){return new Promise((s,p)=>{$.ajax({url:i.url,type:i.method,data:i.body,dataType:"jsonp",success:w=>{s(w)},error:(w,L,T)=>{p(T)}})})}async function f(i){if(i.dataType==="jsonp")return a(i);try{let s=await fetch(i.url,{method:i.method,headers:i.headers,body:i.body});if(!s.ok)throw new Error(`Error fetching ${i.url}: ${s.statusText}`);return s.json()}catch(s){throw console.error("An error occurred:",s),s}}function c(i){let s=[];if(i.forEach(p=>{if(p.status==="fulfilled"&&p.value){let w=p.value;j(w)||s.push(w)}}),s){let p=s.reduce((w,L)=>({...w,...L}),{});localStorage.setItem("crm_data",JSON.stringify(p))}}async function m(i,s){try{let p=await Promise.allSettled(i.map(L=>f(L))),w=!1;p.forEach((L,T)=>{L.status==="rejected"&&i[T].critical&&(w=!0)}),w?n(s,!1,!1):(c(p),n(s,!0,!0))}catch(p){console.error("Error in Promise.allSettled:",p),n(s,!1,!1)}}async function u(i){i.addEventListener("submit",async function(s){var H;s.preventDefault(),s.stopPropagation(),e.submitButton&&(e.submitButton.value=e.submitButton.dataset.wait||e.submitButton.value);let p=[],w={webflow:"webFlow",actionnetwork:"actionNetwork",mailchimp:"mailChimp",zapier:"zapier",amnesty:"amnesty",profundo:"profundo"},L=((H=i.dataset.crm)==null?void 0:H.toLowerCase())||"webflow",T=i.dataset.counterUpdate;if(L!=="none")if(L&&w.hasOwnProperty(L)){let st=w[L];p.push(U[st](i))}else p.push(U.fcrm(i));T&&T!=="default"&&p.push(r(T,i)),p.length>0&&await m(p,i)})}return{handleForm:u}}function W(){let t=document.querySelectorAll("[data-crm]");for(let e of t)lt(e).handleForm(e)}var D=class{constructor(){this.counters=new Map}async getCounter(e){if(this.counters.has(e))return this.counters.get(e);let r=new URL(S.counterPath+e,S.apiUrl),n=(async()=>{try{let a=await fetch(r);return a.ok?await a.json():void 0}catch{return}})();this.counters.set(e,n);let o=await n;return this.counters.delete(e),o}},_=new D;async function G(){try{let t=await fetch(S.jsDelivrUrl);return t.ok?`v${(await t.json()).version}`:"latest"}catch{return"latest"}}function dt(){function t(c,m){return c>=m?100:Math.round(c/m*100)}function e(c){let m={350:50,500:100,2e3:250,5e3:500,2e4:2500,5e4:5e3,1e5:1e4,2e5:25e3,5e5:5e4,1e6:1e5},u=25e4,g=Object.keys(m).map(Number).find(h=>h>=c),d=g?m[g]:u;return Math.ceil(c*1.05/d)*d}function r(c,m){return c*1.05<m.target||!m.autoTarget?m.target:e(c)}function n(c,m,u){c.style.width=t(m,u)+"%"}function o(c,m,u){try{let l=new Intl.NumberFormat(u.locale,u.notation).format(m);c.textContent=l}catch{u.notation.useGrouping=!1,u.notation.notation="standard";let l=new Intl.NumberFormat(void 0,u.notation).format(m);c.textContent=l}}function a(c,m,u){m<=u.removeBelow&&(c.style.display="none"),m>=u.hideBelow&&(c.style.opacity="1")}async function f(c){var i;let m=c.dataset.counterName||"default",u={target:parseInt(c.dataset.counterTarget||"0",10),hideBelow:parseInt(c.dataset.counterHideBelow||"0"),removeBelow:parseInt(c.dataset.counterRemoveBelow||"0"),autoTarget:!!c.dataset.counterAutoTarget||!0,locale:c.dataset.counterLocale||document.documentElement.lang||"undefined",notation:{notation:((i=c.dataset.counterNotation)==null?void 0:i.toLowerCase())||"standard",useGrouping:!0}},l;if(m.toLowerCase()==="default")l=125;else{let s=await _.getCounter(m);s?l=s.count:l=0}if(c.classList.contains("counter-current-value"))o(c,l,u),a(c,l,u);else{let s=c.querySelectorAll(".counter-current-value");for(let p of s)o(p,l,u),a(p,l,u)}let g=r(l,u),d=c.querySelectorAll(".counter-target-value");for(let s of d)o(s,g,u),a(s,l,u);let h=c.querySelectorAll(".counterbar-limiter");for(let s of h)n(s,l,g);a(c,l,u)}return{processCounterElement:f}}function K(){let t=`
      .counter-target-value,
      .counter-current-value,
      .counter_container {
          opacity: 0;
          transition: opacity 0.7s;
      }
  `,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}function Y(){let t=document.querySelectorAll("[data-counter-name]"),e=dt();for(let r of t)e.processCounterElement(r)}var k=(t,e=!0)=>t.cloneNode(e);function A(t){t&&t.classList.contains("cloak")&&t.classList.remove("cloak")}function X(){{let t=`.cloak { 
			opacity: 0;
			height: 0px;
      overflow: hidden;
			margin: 0;
      padding-top: 0;
      padding-bottom: 0;
		}`,e=document.createElement("style");e.textContent=t,document.head.appendChild(e)}}function Q(){var c,m;let t=document.querySelectorAll("[data-counter-name]"),r=(m=(c=Array.from(t).find(u=>u.dataset.counterLocale))==null?void 0:c.dataset.counterLocale)!=null?m:document.documentElement.lang||"en";r.toLowerCase()==="none"&&(r=document.documentElement.lang||"en");function n(u,l){let g=k(l),d=g.querySelector('[data-template="last-person-name"]'),h=g.querySelector('[data-template="last-person-time"]');return d&&h&&(d.innerText=u.name,h.innerText=o(u.date,r)),g}function o(u,l){let g=new Date,d=new Date(u),h=new Date(d.getTime()-d.getTimezoneOffset()*6e4),i=Math.floor((g.getTime()-h.getTime())/1e3),s=new Intl.RelativeTimeFormat(l,{numeric:"auto"});if(i<60)return s.format(-i,"second");let p=Math.floor(i/60);if(p<60)return s.format(-p,"minute");let w=Math.floor(i/3600);if(w<12)return s.format(-w,"hour");let L=Math.floor(i/86400);return s.format(-L,"day")}function a(u){let l=u.last_person.names;return l.reverse(),l.filter((d,h,i)=>i.findIndex(s=>s.name===d.name)===h)}async function f(u,l){let g=l.querySelector('[data-template="last-person"]');if(!g)return;let d=g.parentElement;g.remove();let h=await _.getCounter(u);if(!h||!h.last_person||!h.last_person.names||h.last_person.names.length<2){d==null||d.remove();return}let s=a(h).map(p=>n(p,g));s.length>0&&d&&(A(d),d.append(...s)),s.forEach(p=>{setTimeout(function(){A(p)},100)})}t.forEach(u=>{let l=u.dataset.counterName||"default";f(l,u)})}function M(t){let e=JSON.parse(localStorage.getItem(t)||"{}");return Object.entries(e)}function Z(){function t(a){let f=M("forwardedform");I(f);function c(g){let d=Array.from(new URLSearchParams(window.location.search),([h,i])=>`${h}: ${i}`).join(", ");return g.find(([h])=>h==="utm")||g.push(["utm",d]),g}let m=c(f);function u(g){g.forEach(([d,h])=>{let i=document.createTextNode(h).textContent,s=`<input type="hidden" id="${d}" name="${d}" value="${i}">`;a.insertAdjacentHTML("afterbegin",s)})}u(m);function l(g){let d="",h=["first_name","first-name","firstname","first","fname","f-name","given_name","given-name","givenname","given"];g.forEach(([s,p])=>{h.includes(s.toLowerCase())&&(d=p)});let i=document.querySelectorAll("[data-insert-name]");i.length>0&&d!==""&&r(i,d)}l(m)}function e(a){let f=new URLSearchParams(window.location.search),c=Array.from(f,([g,d])=>`${g}: ${d}`),m=a.getAttribute("redirect"),u=m+(m!=null&&m.includes("?")?"&":"?")+f.toString();a.setAttribute("redirect",u),a.setAttribute("data-redirect",u),a.addEventListener("change",()=>{l(a)}),a.addEventListener("input",()=>{l(a)});function l(g){let d=new FormData(g),h=c.join(", ");d.set("utm",h),localStorage.setItem("forwardedform",JSON.stringify(Object.fromEntries(d)))}}function r(a,f){let c={"no-space":f,"leading-space":"&nbsp;"+f,"trailing-space":f+"&nbsp;","double-space":"&nbsp;"+f+"&nbsp;"};a.forEach(m=>{let u=m.getAttribute("data-insert-name")||"leading-space";c.hasOwnProperty(u)&&(m.innerHTML=c[u])})}let n=document.querySelectorAll("[data-crm]");n.length>0&&n.forEach(function(a){e(a)});let o=document.querySelectorAll('[data-load-petition="true"]');o.length>0&&o.forEach(function(a){t(a)})}function tt(){document.querySelectorAll("[data-copy]").forEach(e=>{e.addEventListener("mouseover",function(){e.style.cursor="pointer"}),e.addEventListener("click",async function(){let r="",n=e.getAttribute("data-copy")||"";if((n==null?void 0:n.toLowerCase())==="url")r=window.location.href;else if((n==null?void 0:n.toLowerCase())==="prev-url")r=document.referrer||"";else{let o=document.getElementById(n);o!=null&&o.textContent?r=o.textContent:r=n||""}try{await navigator.clipboard.writeText(r),console.log("Copied to clipboard:",r.toString())}catch(o){console.error("Failed to copy: ",o)}})})}async function et(){let t=document.querySelectorAll("[data-js-version]");if(t.length<1)return;let e=document.querySelector('script[src$="agera.js"]'),r="";if(e){let{src:n}=e,o=n.match(/@([^/]+)/);if(o){let[,a]=o;r=a,r.toLowerCase().includes("latest")&&(r=await G())}}r!==""&&t.forEach(n=>{n.innerText=r})}var nt="data-insert-name";function ft(t){let e="",r=["first_name","first-name","firstname","first","fname","f-name","given_name","given-name","givenname","given"];t.forEach(([o,a])=>{r.includes(o.toLowerCase())&&(e=a)});let n=document.querySelectorAll(`[${nt}]`);n.length>0&&e!==""&&pt(n,e)}function pt(t,e){let r={"no-space":e,"leading-space":"&nbsp;"+e,"trailing-space":e+"&nbsp;","double-space":"&nbsp;"+e+"&nbsp;"};t.forEach(n=>{let o=n.getAttribute(nt)||"leading-space";r.hasOwnProperty(o)&&(n.innerHTML=r[o])})}function rt(){let t=M("forwardedform");ft(t)}function ot(){let t=new URLSearchParams(window.location.search);document.querySelectorAll("[data-redirect]").forEach(r=>{let n=r.getAttribute("data-redirect");try{if(n){let o=new URL(n,document.baseURI),a=new URL(o.toString()),f=a.searchParams;t.forEach((c,m)=>{f.has(m)||f.set(m,c)}),r.setAttribute("data-redirect",a.toString())}}catch(o){console.error("An error occurred:",o)}})}function at(){let t=[document.documentElement.lang||"en","en"];document.querySelectorAll("[data-insert-time]").forEach(n=>{n.innerText=gt(n,t)}),document.querySelectorAll("[data-remaining-days-to]").forEach(n=>{n.innerText=ht(n,t)})}function gt(t,e){let r=new Date,n=t.getAttribute("data-insert-time"),o="";if((n==null?void 0:n.toLowerCase())==="year")o=r.getFullYear().toString();else if((n==null?void 0:n.toLowerCase())==="month")o=(r.getMonth()+1).toString();else if((n==null?void 0:n.toLowerCase())==="day")o=r.getDate().toString();else if((n==null?void 0:n.toLowerCase())==="date")o=r.toLocaleDateString(e);else if((n==null?void 0:n.toLowerCase())==="datetime")o=r.toLocaleString(e);else if((n==null?void 0:n.toLowerCase())==="time")o=r.toLocaleTimeString(e);else return"";return o}function ht(t,e){let r=new Date,n=t.getAttribute("data-remaining-days-to");try{if(n){let o=new Date(n),a=Math.round((o.getTime()-r.getTime())/(1e3*60*60*24));return new Intl.RelativeTimeFormat(e,{numeric:"auto"}).format(a,"day")}}catch(o){console.error("remainingDays error:",o)}return""}function wt(){K(),X(),document.addEventListener("DOMContentLoaded",()=>{Z(),Y(),W(),Q(),rt(),at(),ot(),et(),tt()})}window.agera||(window.agera=!0,wt());})();
